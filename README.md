### 实验环境

1. 操作系统：Windows11
2. IDE:VS2022
3. 抓包库：WinPcap-4.1.1
4. 图形库：MFC

### 设计与实现思路

本次主要抓取局域网中的数据包，并分析了以太网数据帧，IP数据包和TCP数据报文的头部信息。

#### 命令行版(参考网上Winpcap抓包库API使用方法)

使用Winpcap抓包库抓取网络包并且显示。

1. 使用Winpcap抓包库遍历并显示出主机的网卡，选择要监听的网卡打开混杂模式。
2. 抓取到以太网MAC帧之后，分析以太网数据帧，如源MAC地址、目的MAC地址、网络层协议。
3. 如果2抓到的以太网数据帧的网络层协议为IP协议就在2的基础上继续解析IP数据包，如IP版本、首部长度、服务类型、 总长度、标识、片偏移、生存时间、首部检验和、源IP、目的IP、传输层协议。
4. 如果2抓到的IP数据包的传输层协议为TCP协议就在3的基础上继续解析TCP数据报文，如源端口、目的端口、应用层协议、序列号、确认号、首部长度、保留字段、控制位、窗口大小、检验和、紧急指针字段。

#### GUI版

基于命令行版，使用MFC将抓包结果可视化。使用多线程，主线程负责可视化结果，对等线程实现抓包。
